<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>JPG <--> PDF</title>
<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center; /* Center both vertically and horizontally */
        min-height: 100vh;
        margin: 0;
        padding: 20px;
        box-sizing: border-box;
    }
    .container {
        text-align: center;
        width: 60%;
        max-width: 700px;
        display: flex;
        flex-direction: column;
        align-items: center;
    }
    h1 {
        font-size: 36px;
        margin-bottom: 20px;
    }
    .image-section {
        display: flex;
        justify-content: center; /* Center horizontally */
        align-items: center;
        gap: 30px; /* Spacing between image and radio group */
        margin-bottom: 30px;
        flex-wrap: wrap; /* Wrap on small screens if needed */
    }
    /* Increased image size */
    .image-section img {
        width: 200px;
    }
    /* Make radio buttons and labels more compact and centered */
    .radio-group {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        font-size: 20px;
    }
    .radio-label {
        display: flex;
        align-items: center;
        margin-bottom: 10px;
        white-space: nowrap;
    }
    /* Style the file uploader with yellow background and black border */
    .uploader {
        display: flex;
        flex-direction: column;
        align-items: center;
        background-color: yellow;
        border: 2px solid black;
        padding: 15px 20px;
        border-radius: 8px;
        width: 80%;
        max-width: 400px;
        margin-top: 20px;
    }
    #file-uploader {
        font-size: 18px;
        margin-bottom: 10px;
    }
    #error-message {
        color: red;
        font-weight: bold;
        min-height: 20px;
        text-align: center;
    }
</style>
</head>
<body>

<div class="container">
    <h1>JPG &lt;--&gt; PDF</h1>
    <div class="image-section">
        <img src="pic2pdf_image.png" alt="Conversion Image" />
        <div class="radio-group">
            <label class="radio-label">
                <input type="radio" name="conversion" value="pdf-to-jpg" checked />
                PDF to JPG
            </label>
            <label class="radio-label">
                <input type="radio" name="conversion" value="jpg-to-pdf" />
                JPG to PDF
            </label>
        </div>
    </div>
    <div class="uploader">
        <input type="file" id="file-uploader" />
        <div id="error-message"></div>
    </div>
</div>

<script>
const fileInput = document.getElementById('file-uploader');
const errorMessage = document.getElementById('error-message');
const fileNameDisplay = document.getElementById('file-name-display');

function getConversionType() {
    return document.querySelector('input[name="conversion"]:checked').value;
}

function uploadAndConvertFile(file) {
    errorMessage.textContent = '';
    if (!file) return;
    const fileName = file.name.toLowerCase();
    const extension = fileName.substring(fileName.lastIndexOf('.') + 1);
    const conversionType = getConversionType();

    // Validate client-side
    if (conversionType === 'pdf-to-jpg' && extension !== 'pdf') {
        errorMessage.textContent = 'Error: Please upload a .pdf file.';
        return;
    }
    if (conversionType === 'jpg-to-pdf' && extension !== 'jpg') {
        errorMessage.textContent = 'Error: Please upload a .jpg file.';
        return;
    }

    // Prepare form data
    const formData = new FormData();
    formData.append('file', file);
    formData.append('conversionType', conversionType);

    // Send to backend
    fetch('/convert', {  // Adjust URL as needed
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) throw new Error('Conversion failed.');
        return response.blob(); // expecting file blob in response
    })
    .then(blob => {
        // Create a link to download the converted file
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;

        // Set filename based on conversion
        let downloadFilename = '';
        if (getConversionType() === 'pdf-to-jpg') {
            downloadFilename = 'converted.jpg';
        } else {
            downloadFilename = 'converted.pdf';
        }
        a.download = downloadFilename;
        document.body.appendChild(a);
        a.click();
        a.remove();
        window.URL.revokeObjectURL(url);
    })
    .catch(error => {
        errorMessage.textContent = error.message;
    });
}

// Show filename when selected
fileInput.addEventListener('change', () => {
    errorMessage.textContent = '';
    const file = fileInput.files[0];
    if (file) {
        fileNameDisplay.textContent = `Selected file: ${file.name}`;
        // Optional: auto-upload upon selection
        uploadAndConvertFile(file);
    } else {
        fileNameDisplay.textContent = '';
    }
});

// Switch conversion type
document.querySelectorAll('input[name="conversion"]').forEach(rb => {
    rb.addEventListener('change', () => {
        // Clear previous selection
        fileInput.value = '';
        fileNameDisplay.textContent = '';
        errorMessage.textContent = '';
    });
});
</script>

</body>
</html>
